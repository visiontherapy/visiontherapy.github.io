<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Letter Track</title>
  <meta name="darkreader-lock" />

  <link rel="stylesheet" href="vision.css" />

  <style>
    #output {
      font-size: 25pt;
      margin: 1.5em 2em;
      line-height: 1.5em;
    }

    .hovershow {
      opacity: 0;
      cursor: default;
    }

    .hovershow:hover {
      opacity: 1;
      ;
    }
  </style>
</head>

<body>
  Wordbank:
  <textarea id="wordbank">
There was nothing so very remarkable in that; nor did Alice think it so very much out of the way to hear the Rabbit say to itself, “Oh dear! Oh dear! I shall be late!” (when she thought it over afterwards, it occurred to her that she ought to have wondered at this, but at the time it all seemed quite natural); but when the Rabbit actually took a watch out of its waistcoat-pocket, and looked at it, and then hurried on, Alice started to her feet, for it flashed across her mind that she had never before seen a rabbit with either a waistcoat-pocket, or a watch to take out of it, and burning with curiosity, she ran across the field after it, and fortunately was just in time to see it pop down a large rabbit-hole under the hedge. THE term novel has been made to cover books of such diverse character,
now-a-days, that the reader is almost entitled to demand of a novelist
that he shall affix some distinct label to the book he is putting
forth, and make it clear beforehand whether his work is a dialogue on
religion, a satire on morals, a political tract, a study in slum life,
or a mere romance. This consideration must serve as my excuse for
saying a few words about the ideas which have guided me in writing the
present work; although I shall incur the danger of a comparison between
the moon at which I have aimed, and the humble tree which I have hit.

In this story, then, as in some others which I have written, or am
writing, I have sought to embody the romance of contemporary history.
It cannot be true that one age or country is in reality more poetical
than any other; the difference, if any, must be that it requires a
little more imagination to perceive the romance which lies around us,
than that which is ready gathered for us in the pages of the historian.
If it be said that some of the greatest masters have gone to past
times for their inspiration, their disciple may perhaps allege that as
a reason for not venturing into the well-trodden ground. But in fact
many of the books which have been most admired in the class of what are
called historical novels have owed a part of their charm to the flavour
of antiquity which their accomplished writers have contrived to impart
to them by mannerisms of style and by the copious use of historical
allusion. However great the attraction of such writing may be, it must
not be forgotten that the greatest, perhaps the first, of historical
romancers--I mean Shakespeare--relied upon no such artifices, but on
the intrinsic interest of his themes and his dramatic presentation
of them. Neither is it the antiquarian taste which is appealed to by
such a book as the “Three Musketeers.” It may even be affirmed, on the
other hand, that the interest with which stories are thus invested is
essentially false, and foreign to the story-tellers art.

The keen pleasure with which the historical scholar reads the “Iliad”
and the “Odyssey” is the accidental result of time, and certainly
never entered into the aims of the composer or compiler of those
works. The novels of Emile Zola may similarly fascinate the student
in years to come, because he will feel that the manners they record
are genuine. But with what confidence can he regard the Wardour Street
properties which bulk so largely in the novels of some modern writers?
Unless these books tell stories whose interest is independent of
adventitious attraction, assuredly they will not continue to be read.

The true aim of the artist in fiction must always be to describe an
interesting action,--the Greeks would have said, a great action. The
characters which still live for us in fiction are those which their
creators have revealed to us through their actions. The analytical
novel of character, as it is termed, bears the same relation to true
romance as the surgeons anatomical model bears to a portrait of
Velasquez. It is the business of the story-teller to produce, not a
photograph of one who sits in a chair, but a kinetoscope, with every
limb in motion. The analytical novelist, when he has written his
analytical novel, should regard it as merely a preparatory study, and
should tear it up and then write a real novel in which the characters
so carefully analysed will by their movements disclose all those
traits of which their creator has laboured to convince himself.

This is why the play is greater than the novel. The playwright--robbed
of his Chorus--cannot inflict upon us these tedious dissertations, he
cannot leave his persons standing about idly on the stage, while he
lectures to us on their inner nature as revealed to his Röntgen vision.
The story told in these pages was conceived by the author as the
subject of a play. The only reason it appears in the guise of a novel
is because, when it was written, the author had no acquaintance with
theatrical managers, and a play written merely to be read in a book has
always appeared to him a monstrosity. He therefore reconstructed his
romance, making such alterations as seemed needful when the characters
were no longer visible of themselves, and when, moreover, he was
debarred from that crowding of circumstance, that rush and climax of
events, which the stage demands and justifies, but which on the written
page would seem abrupt and harsh.

Most readers will trace in the hero of this book a resemblance to a
certain king whose fate attracted attention not so very many years ago.
I would ask that the comparison shall be carried no farther. This book
is in no sense taken from history. All that I have intended to do has
been to conceive a romantic interpretation for a tragical event, and to
set forth that interpretation as a story to be read for its own sake,
if at all.

</textarea>
  <button id="go">go</button>
  <br />
  <button id="reload">newchart</button>

  <div id="output"></div>

  <script>
    let digraphs = {};

    document.querySelector("#go").onclick = function () {
      getdigraphs();
      showchart();
    };

    document.querySelector("#reload").onclick = function () {
      showchart();
    };




    getdigraphs();
    showchart();

    function getdigraphs() {
      let words = document.querySelector("#wordbank").value.replace(/[^\w\s]/g, " ").toLowerCase();


      for (let word of words.split(/\s+/)) {
        let sword = word.split("");
        let letters = [];
        for (let c = 0; c < sword.length; c++) {
          letters.push(sword[c]);

          if (letters.length == 2) {
            let digr = letters.join("");
            //console.log(digr);

            if (typeof digraphs[letters[0]] === "undefined") {
              digraphs[letters[0]] = { [letters[1]]: 1 };
            } else if (typeof digraphs[letters[0]][letters[1]] === "undefined") {
              digraphs[letters[0]][letters[1]] = 1;
            } else {
              digraphs[letters[0]][letters[1]]++;
            }

            letters.shift();
          }
        }
      }

      // console.log(digraphs);
      // let flatdigraphs= [];
      // for (const prima of Object.keys(digraphs)) {
      //   for (const secund of Object.keys(digraphs[prima])) {
      //     flatdigraphs.push(prima+secund);
      //   }
      // }
      // console.log(flatdigraphs);
    }





    function showchart() {
      let maxwords = 100;

      let wordmin = 3;
      let wordmax = 5;

      let alphabet = "abcdefghijklmnopqrstuvwxyz";
      let alpha = (alphabet + "#").split("");
      let alphaorder = alphabet.split("");

      let sequence = "";
      let string = "";
      let wordlength = wordmin + Math.floor(Math.random() * (wordmax - wordmin + 2));
      let wordcount = 0;

      // Need to drop alphaorder[0] at least once every maxwords/26 characters


      while (wordcount < maxwords) {
        let newltr = getchar(sequence);

        if (alphaorder.length > 0 && newltr == alphaorder[0]) {
          // if newltr is in alphabetical order, cross it off the list
          alphaorder.shift();
          // string += '"';
          // console.log("alphaorder", alphaorder, sequence + newltr);
        }

        sequence += newltr;
        string += newltr;
        //console.log(sequence.length, wordlength, sequence.length%wordlength);
        if (sequence.length == wordlength) {
          string += " ";
          sequence = "";
          wordlength = 3 + Math.floor(Math.random() * 3);
          wordcount++;
        }

        if (wordcount == maxwords && alphaorder.length > 0) {
          console.log("maxed out", alphaorder);
          // need more words to complete the sequence
          wordcount -= alphaorder.length;
        }
      }

      //console.log(string);
      document.querySelector("#output").innerHTML = string + "<span class='hovershow'>" + string.split(" ").length + "</span>";

      function getchar(sequence = "") {
        let chr = alpha[Math.floor(Math.random() * alpha.length)];
        let prevchr = sequence ? sequence.match(/.$/)[0] : "";

        if (chr == "#") { //27th "letter" => ensure alpha order
          chr = alphaorder[0]; //alphaorder.push(alphaorder.shift());
        }

        /*
          if (prevchr == chr) {
            getchar();
          } else */
        if (!prevchr && digraphs[chr]) {
          return chr;
        }

        if (!digraphs[prevchr]) {
          console.log("no digraph with this start", prevchr);
          return "";
          //return getchar(sequence);
        }

        if (digraphs[prevchr] && digraphs[prevchr][chr]) {
          //console.log("OK:", prevchr + chr);
          return chr;
        }

        //console.log("were here", prevchr,chr);
        return getchar(sequence);

      }
    }
    //}


    /*
    
    https://trekhleb.medium.com/weighted-random-in-javascript-4748ab3a1500
    
    The more efficient approach would be to:
    
        Prepare the list of cumulative weights for each item (i.e. the cumulativeWeights list which will have the same number of elements as the original weights list). In our case it will look like this: cumulativeWeights = [3, 3 + 7, 3 + 7 + 1] = [3, 10, 11]
        Generate the random number randomNumber from 0 to the highest cumulative weight value. In our case, the random number will be in a range of [0..11]. Let's say that we have randomNumber = 8.
        Go through the cumulativeWeights list from left to right and pick the first element which is higher or equal to the randomNumber. The index of such element we will use to pick the item from the items array.
    
    The idea behind this approach is that the higher weights will “occupy” more numeric space. Therefore, there is a higher chance that the random number will fall into the “higher weight numeric bucket”.
    
    
    
    
    */
  </script>

</body>

</html>